<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Bảng phân công công tác cá nhân</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-…"
      crossorigin="anonymous"
    />
    <style>
      th,
      td {
        vertical-align: middle;
        text-align: center;
      }
      th.rotate {
        height: 140px;
        white-space: nowrap;
      }
      th.rotate > div {
        transform: translate(0px, 50px) rotate(-90deg);
        width: 30px;
      }
    </style>
  </head>
  <body>
    <!-- Navbar -->
    <div th:replace="user/navbar_giangvien :: navbar1"></div>

    <div class="container mt-4">
      <h2 class="text-center mb-4">BẢNG PHÂN CÔNG CÔNG TÁC CỦA GIẢNG VIÊN</h2>
      <div
        th:if="${error}"
        class="alert alert-danger text-center"
        th:text="${error}"
      ></div>
      <div th:if="${gv != null}">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th rowspan="2">Mã CB</th>
              <th rowspan="2">Họ và tên GV</th>
              <th rowspan="2">Năm sinh</th>
              <th rowspan="2">Chức danh, học vị</th>
              <th colspan="9">Phân công giảng dạy</th>
            </tr>
            <tr>
              <th>Tên học phần</th>
              <th>Mã học phần</th>
              <th>Số TC</th>
              <th>Số tiết của HP</th>
              <th>Số lượng lớp, nhóm</th>
              <th>Học kì 1</th>
              <th>Học kì 2</th>
              <th>Học kì 3</th>
              <th>Tổng số tiết giảng dạy của GV</th>
            </tr>
          </thead>
          <tbody>
            <th:block th:with="rows=${gv.hocphanMap.size() + 1}">
              <tr th:each="assign, aStat : ${gv.hocphanMap}">
                <td
                  th:if="${aStat.index == 0}"
                  th:rowspan="${rows}"
                  th:text="${gv.maGv}"
                ></td>
                <td
                  th:if="${aStat.index == 0}"
                  th:rowspan="${rows}"
                  th:text="${gv.hoTen}"
                ></td>
                <td
                  th:if="${aStat.index == 0}"
                  th:rowspan="${rows}"
                  th:text="${gv.namSinh}"
                ></td>
                <td
                  th:if="${aStat.index == 0}"
                  th:rowspan="${rows}"
                  th:text="${gv.trinhDo}"
                ></td>
                <td th:text="${assign.value.tenHp}"></td>
                <td th:text="${assign.value.maHp}"></td>
                <td th:text="${assign.value.soTinChi}"></td>
                <td
                  th:text="${assign.value.soTietLyThuyet + assign.value.soTietThucHanh}"
                ></td>
                <td th:text="${gv.groupsPerCourse[assign.value.id]}"></td>
                <td th:text="${gv.hockyMap[assign.value.id][0]}"></td>
                <td th:text="${gv.hockyMap[assign.value.id][1]}"></td>
                <td th:text="${gv.hockyMap[assign.value.id][2]}"></td>
                <td
                  th:text="${gv.groupsPerCourse.get(assign.value.id) * (assign.value.soTietLyThuyet + assign.value.soTietThucHanh)}"
                ></td>
              </tr>
              <tr class="table-light">
                <!-- Hàng tổng cộng, có thể bổ sung nếu cần -->
              </tr>
            </th:block>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Bootstrap JS Bundle -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-…"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
