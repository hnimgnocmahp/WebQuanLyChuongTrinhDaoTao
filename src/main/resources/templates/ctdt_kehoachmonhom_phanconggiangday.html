<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Phân công giảng dạy</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
        rel="stylesheet">
</head>
<body>
<div th:replace="fragments :: navbar"></div>

<div class="container mt-4">
  <h1 class="mb-4">Danh sách phân công giảng dạy</h1>
  <table class="table table-bordered align-middle text-center">
    <thead class="table-light">
    <tr>
      <th>STT</th><th>Mã HP</th><th>Tên HP</th><th>TC</th><th>Khóa</th>
      <th colspan="4">Số tiết</th><th>HS HP</th><th>Tổng nhóm</th><th>SV/nhóm</th>
      <th>Nhóm</th><th>Mã CBGD</th><th>Họ tên CBGD</th><th>Thực hiện</th><th>Thực tế</th>
    </tr>
    <tr class="table-light">
      <th></th><th></th><th></th><th></th><th></th>
      <th>LT</th><th>BT</th><th>TH</th><th>TC</th>
      <th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th>
    </tr>
    </thead>
    <tbody>
    <th:block th:each="course, cStat : ${courses}">
      <!-- tính số dòng rowspan bằng số phân công -->
      <th:block th:with="rows=${course.assignments.size()}">
        <tr th:each="assign, aStat : ${course.assignments}">
          <!-- STT chỉ in một lần -->
          <td th:if="${aStat.index == 0}"
              th:rowspan="${rows}"
              th:text="${cStat.index + 1}">1</td>

          <!-- Thông tin học phần chỉ in một lần -->
          <td th:if="${aStat.index == 0}"
              th:rowspan="${rows}"
              th:text="${course.hocPhan.maHp}">HP001</td>
          <td th:if="${aStat.index == 0}"
              th:rowspan="${rows}"
              th:text="${course.hocPhan.tenHp}">Triết học</td>
          <td th:if="${aStat.index == 0}"
              th:rowspan="${rows}"
              th:text="${course.hocPhan.soTinChi}">3</td>
          <td th:if="${aStat.index == 0}"
              th:rowspan="${rows}"
              th:text="${course.namHoc + ' - HK ' + course.hocKy}">2023 - HK 1</td>

          <td th:if="${aStat.index == 0}"
              th:rowspan="${rows}"
              th:text="${course.hocPhan.soTietLyThuyet}">45</td>
          <td th:if="${aStat.index == 0}"
              th:rowspan="${rows}"
              th:text="0">0</td>
          <td th:if="${aStat.index == 0}"
              th:rowspan="${rows}"
              th:text="${course.hocPhan.soTietThucHanh}">0</td>
          <td th:if="${aStat.index == 0}"
              th:rowspan="${rows}"
              th:text="${course.hocPhan.soTietLyThuyet + course.hocPhan.soTietThucHanh}">45</td>

          <td th:if="${aStat.index == 0}"
              th:rowspan="${rows}"
              th:text="${course.hocPhan.heSoHocPhan}">
          <td th:if="${aStat.index == 0}"
              th:rowspan="${rows}"
              th:text="1"></td>
          <td th:if="${aStat.index == 0}"
              th:rowspan="${rows}"
              th:text="${course.soLuongSv}">60</td>

          <!-- Thông tin phân công -->
          <td th:text="${course.maNhom}">NHOM01</td>
          <td th:text="${assign.giangVien.maGv}">GV001</td>
          <td th:text="${assign.giangVien.hoTen}">Trần Văn A</td>
          <td th:text="${(assign.soTiet)}">45</td>
          <td th:text="${#numbers.formatDecimal(assign.soTiet * course.hocPhan.heSoHocPhan, 0, 'COMMA', 0, 'POINT')}">45</td>
        </tr>
      </th:block>
    </th:block>
    </tbody>
  </table>
</div>
</body>
</html>
